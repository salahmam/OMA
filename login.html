<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل الدخول - نظام OMA</title>
<style>
body {
    font-family: 'Cairo', sans-serif;
    background: linear-gradient(180deg,#f5f9ff,#fff);
    display:flex; justify-content:center; align-items:center; height:100vh; margin:0;
}
.card {
    background:white; padding:24px; border-radius:10px;
    box-shadow:0 6px 18px rgba(0,0,0,0.08); width:320px;
}
h2 { text-align:center; color:#004aad; }
input[type="email"], input[type="password"]{
    width:100%; padding:10px; margin:10px 0; border-radius:8px; border:1px solid #ccc;
}
.btn{
    width:100%; padding:10px; background:#004aad; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:700;
}
.alert { color:red; font-size:13px; display:none; margin-top:8px; text-align:center; }
</style>
</head>
<body>
<div class="card">
    <h2>تسجيل الدخول</h2>
    <input id="email" type="email" placeholder="البريد الإلكتروني" required />
    <input id="password" type="password" placeholder="كلمة المرور" required />
    <button id="loginBtn" class="btn">دخول</button>
    <div id="alert" class="alert">بيانات غير صحيحة</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "API_KEY_HERE",
  authDomain: "PROJECT_ID.firebaseapp.com",
  projectId: "PROJECT_ID",
  storageBucket: "PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const loginBtn = document.getElementById("loginBtn");
const alertBox = document.getElementById("alert");

loginBtn.addEventListener("click", async () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password) return;

    const usersRef = collection(db, "users");
    const q = query(usersRef, where("email", "==", email), where("password", "==", password));
    const snapshot = await getDocs(q);

    if (!snapshot.empty) {
        const user = snapshot.docs[0].data();
        // الدور: admin, teacher, student
        if(user.role === "admin") window.location.href = "index.html"; // لوحة الإدارة
        else if(user.role === "teacher") window.location.href = "teacher_attendance.html"; // صفحة الأستاذ
        else if(user.role === "student") window.location.href = "student_dashboard.html"; // صفحة الطالب (يمكن إنشاؤها لاحقًا)
    } else {
        alertBox.style.display = "block";
        setTimeout(()=> alertBox.style.display = "none", 3000);
    }
});
</script>
</body>
</html>