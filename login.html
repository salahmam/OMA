<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل الدخول - نظام OMA</title>
<style>
  body {
    font-family: 'Cairo', sans-serif;
    background: #f5f9ff;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }
  .login-box {
    background: #fff;
    padding: 24px 32px;
    border-radius: 12px;
    box-shadow: 0 6px 18px rgba(6,20,30,0.06);
    width: 320px;
  }
  h2 { text-align:center; color:#004aad; }
  input { width:100%; padding:10px; margin:8px 0; border-radius:8px; border:1px solid #d6dde9; }
  button { width:100%; padding:10px; background:#004aad; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:700; }
</style>
</head>
<body>
<div class="login-box">
  <h2>تسجيل الدخول</h2>
  <form id="loginForm">
    <input type="email" id="email" placeholder="البريد الإلكتروني" required>
    <input type="password" id="password" placeholder="كلمة المرور" required>
    <button type="submit">دخول</button>
  </form>
</div>

<script type="module">
import { app } from "./firebase-config.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

const auth = getAuth(app);
const loginForm = document.getElementById("loginForm");

loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  try {
    await signInWithEmailAndPassword(auth, email, password);
    window.location.href = "index.html"; // تحويل بعد تسجيل الدخول
  } catch (err) {
    alert("خطأ في تسجيل الدخول: " + err.message);
  }
});

// التأكد من تسجيل الدخول قبل السماح بالوصول للصفحة
onAuthStateChanged(auth, (user) => {
  if (user) {
    window.location.href = "index.html";
  }
});
</script>
</body>
</html>