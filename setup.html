<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - OMA</title>
<style>
body {
  font-family: 'Cairo', sans-serif;
  background: #f5f9ff;
  color: #102027;
  padding: 30px;
  direction: rtl;
}
.card {
  background: #fff;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
}
button {
  background: #004aad;
  color: #fff;
  border: none;
  padding: 10px 16px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
}
button:hover { background: #003a8c; }
pre {
  background: #eef4ff;
  padding: 10px;
  border-radius: 8px;
  overflow-x: auto;
  white-space: pre-wrap;
}
</style>
</head>
<body>

<h2>ğŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª OMA (Firestore)</h2>
<p>Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø¨Ø§Ù„Ø£Ø³ÙÙ„ØŒ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>

<div class="card">
  <button id="setupBtn">ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</button>
  <pre id="log"></pre>
</div>

<!-- Ù…Ù„Ø§Ø­Ø¸Ø©: Ù†Ø³ØªÙˆØ±Ø¯ firebase-config.js Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø³Ø§Ø± Ù…Ø·Ù„Ù‚ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù„Ù‰ GitHub Pages -->
<script type="module">
/* ------------- Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ------------- */
/* firebase-config.js ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ÙÙŠ: https://salahmam.github.io/OMA/firebase-config.js
   ÙˆÙ…Ø­ØªÙˆØ§Ù‡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØµØ¯Ø± (export) Ø§Ù„Ù…ØªØºÙŠÙ‘Ø± `db` (see note Ø£Ø¯Ù†Ø§Ù‡) */
import { db } from "https://salahmam.github.io/OMA/firebase-config.js";
import { setDoc, doc } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

const log = document.getElementById("log");
const setupBtn = document.getElementById("setupBtn");

function addLog(msg){ log.textContent += msg + "\n"; }

setupBtn.addEventListener("click", async ()=>{
  setupBtn.disabled = true;
  setupBtn.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...";
  addLog("ğŸ”¹ Ø¨Ø¯Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©...");

  try {
    // ğŸ“˜ Collection: students
    await setDoc(doc(db, "students", "example_student"), {
      name: "Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ",
      address: "Ø¨ØºØ¯Ø§Ø¯",
      phone: "0770000000",
      level: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰",
      group: "A1",
      subjects: [
        { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", teacherId: "", fee: 0, remaining: 0, payments: [] },
        { name: "Ø¹Ù„ÙˆÙ…", teacherId: "", fee: 0, remaining: 0, payments: [] }
      ],
      joinDate: "2025-11-07",
      totalFees: 500000,
      note: "",
      createdAt: new Date()
    });
    addLog("âœ… students collection ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡.");

    // ğŸ“— Collection: teachers
    await setDoc(doc(db, "teachers", "example_teacher"), {
      name: "Ø£Ø³ØªØ§Ø° ÙƒØ±ÙŠÙ…",
      phone: "0780000000",
      address: "Ø§Ù„Ø¨ØµØ±Ø©",
      subjects: ["Ø±ÙŠØ§Ø¶ÙŠØ§Øª"],
      teacherPercent: 60,
      createdAt: new Date()
    });
    addLog("âœ… teachers collection ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡.");

    // ğŸ“™ Collection: users
    await setDoc(doc(db, "users", "admin_sample"), {
      name: "Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…",
      email: "admin@oma.com",
      type: "admin",
      createdAt: new Date()
    });
    addLog("âœ… users collection ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡.");

    // ğŸ“’ Collection: settings (document: percentages)
    await setDoc(doc(db, "settings", "percentages"), {
      teacher: 60,
      institute: 40
    });
    addLog("âœ… settings collection ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡.");

    addLog("\nğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!");
    setupBtn.textContent = "âœ… ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­";
    setupBtn.style.background = "#00b67a";

    // â³ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù
    addLog("\nâ¡ï¸ Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø®Ù„Ø§Ù„ 3 Ø«ÙˆØ§Ù†Ù...");
    setTimeout(()=>{
      window.location.href = "dashboard.html";
    }, 3000);

  } catch (e) {
    addLog("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: " + (e.message || e));
    setupBtn.disabled = false;
    setupBtn.textContent = "ğŸš€ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©";
  }
});
</script>

</body>
</html>