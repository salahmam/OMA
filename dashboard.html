<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¹Ù‡Ø¯ - Ù†Ø¸Ø§Ù… OMA</title>
<style>
:root {
  --primary:#004aad;
  --accent:#ffcc33;
  --bg:#f5f9ff;
  --card:#ffffff;
}

body {
  font-family:'Cairo',sans-serif;
  background:var(--bg);
  margin:0;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

header {
  background:var(--primary);
  color:white;
  text-align:center;
  padding:15px;
  font-size:20px;
  font-weight:bold;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
}

header img {
  height:40px;
  width:40px;
  border-radius:50%;
  object-fit:cover;
  background:white;
}

.container {
  flex:1;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  padding:30px;
}

.card {
  background:var(--card);
  text-align:center;
  border-radius:10px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  padding:30px;
  transition:0.3s;
  cursor:pointer;
}
.card:hover {
  transform:translateY(-5px);
  background:#eef4ff;
}
.card h3 { color:var(--primary); }

#logoutBtn {
  background:#d32f2f;
  color:white;
  border:none;
  padding:12px 20px;
  border-radius:8px;
  cursor:pointer;
  font-size:16px;
  margin:30px auto;
  display:block;
  transition:0.3s;
}
#logoutBtn:hover { background:#b71c1c; }

footer {
  text-align:center;
  padding:10px;
  background:#eee;
  font-size:14px;
  color:#555;
}
</style>
</head>
<body>

<header>
  <img id="instituteLogo" src="" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¹Ù‡Ø¯">
  <span id="instituteName">ØªØ­Ù…ÙŠÙ„...</span>
</header>

<div class="container">
  <div class="card" id="studentsCard"><h3>ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h3></div>
  <div class="card" id="teachersCard"><h3>ğŸ‘¨â€ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©</h3></div>
  <div class="card" id="classesCard"><h3>ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­ØµØµ</h3></div>
  <div class="card" id="attendanceCard"><h3>ğŸ•“ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</h3></div>
  <div class="card" id="settingsCard"><h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3></div>
  <div class="card" id="financeCard"><h3>ğŸ’° Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…ØµØ§Ø±ÙŠÙ</h3></div>
</div>

<button id="logoutBtn">ğŸ”“ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>

<footer>Â© 2025 Ù†Ø¸Ø§Ù… OMA Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ø§Ù‡Ø¯</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAMANgdrLgoGIjqLZOcS_qyEqCUOVC7gOU",
  authDomain: "oma0-33cc0.firebaseapp.com",
  projectId: "oma0-33cc0",
  storageBucket: "oma0-33cc0.firebasestorage.app",
  messagingSenderId: "899300774863",
  appId: "1:899300774863:web:0a81a7f5747ef37d49b8ba",
  measurementId: "G-5CKWYQT9XZ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const logoEl = document.getElementById("instituteLogo");
const nameEl = document.getElementById("instituteName");
const logoutBtn = document.getElementById("logoutBtn");

// ğŸŸ¢ Ù…Ù†Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¯ÙˆÙ† ØªØ³Ø¬ÙŠÙ„
onAuthStateChanged(auth, async(user)=>{
  if(!user){
    window.location.href = "institute-login.html";
    return;
  }

  const instituteId = localStorage.getItem("instituteId");
  if(!instituteId){
    alert("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù‡Ø¯.");
    await signOut(auth);
    return window.location.href = "institute-login.html";
  }

  // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù‡Ø¯
  const docSnap = await getDoc(doc(db, "institutes", instituteId));
  if(docSnap.exists()){
    const data = docSnap.data();
    nameEl.textContent = data.name || "Ø§Ù„Ù…Ø¹Ù‡Ø¯";
    if(data.logoUrl) logoEl.src = data.logoUrl;

    // ØªØ·Ø¨ÙŠÙ‚ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø¹Ù‡Ø¯
    if(data.colors){
      document.documentElement.style.setProperty("--primary", data.colors.primary);
      document.documentElement.style.setProperty("--bg", data.colors.bg);
      document.documentElement.style.setProperty("--card", data.colors.card);
      document.documentElement.style.setProperty("--accent", data.colors.accent);
    }
  } else {
    nameEl.textContent = "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù‡Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©";
  }
});

// ğŸ”˜ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
const pageLinks = {
  studentsCard: "students.html",
  teachersCard: "teachers.html",
  classesCard: "classes.html",
  attendanceCard: "attendance.html",
  settingsCard: "settings.html",
  financeCard: "finance.html"
};
Object.keys(pageLinks).forEach(id=>{
  const el = document.getElementById(id);
  if(el){
    el.addEventListener("click", ()=>window.location.href = pageLinks[id]);
  }
});

// ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
logoutBtn.addEventListener("click", async()=>{
  await signOut(auth);
  localStorage.clear();
  alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­");
  window.location.href = "institute-login.html";
});
</script>

</body>
</html>