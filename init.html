<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… - OMA</title>
<style>
body {
  font-family: 'Cairo', sans-serif;
  background: #f5f9ff;
  text-align: center;
  padding: 40px;
  color: #004aad;
}
button {
  padding: 12px 25px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #004aad;
  color: white;
  cursor: pointer;
}
button:hover { background: #003a8c; }
#log {
  margin-top: 20px;
  white-space: pre-wrap;
  text-align: right;
  background: #fff;
  border-radius: 10px;
  padding: 20px;
  max-width: 600px;
  margin: auto;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
</style>
</head>
<body>
<h2>ğŸ”§ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… OMA</h2>
<p>Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ.</p>
<button id="initBtn">Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</button>
<div id="log"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAMANgdrLgoGIjqLZOcS_qyEqCUOVC7gOU",
  authDomain: "oma0-33cc0.firebaseapp.com",
  projectId: "oma0-33cc0",
  storageBucket: "oma0-33cc0.firebasestorage.app",
  messagingSenderId: "899300774863",
  appId: "1:899300774863:web:0a81a7f5747ef37d49b8ba",
  measurementId: "G-5CKWYQT9XZ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const log = document.getElementById("log");
const btn = document.getElementById("initBtn");

function write(msg){ log.innerHTML += `âœ… ${msg}\n`; }

btn.addEventListener("click", async()=>{
  btn.disabled = true;
  write("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...");

  try {
    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (superAdmin)
    const email = "Salahalkaleefa@gmail.com";
    const password = "123456salah";
    const userCred = await createUserWithEmailAndPassword(auth, email, password);
    const uid = userCred.user.uid;

    await setDoc(doc(db,"users",uid),{
      name:"Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…",
      email,
      type:"superAdmin",
      createdAt:serverTimestamp()
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… superAdmin Ø¨Ù†Ø¬Ø§Ø­.");

    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ù‡Ø¯ ØªØ¬Ø±ÙŠØ¨ÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠ
    const instituteId = "demo-institute";
    await setDoc(doc(db,"institutes",instituteId),{
      name:"Ù…Ø¹Ù‡Ø¯ OMA Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",
      email:"oma-demo@oma.edu",
      logo:"https://i.ibb.co/vqC4ZP6/institute-logo.png",
      theme:{
        primary:"#004aad",
        accent:"#ffcc33",
        background:"#f5f9ff"
      },
      createdAt:serverTimestamp(),
      plan:{
        type:"ØªØ¬Ø±ÙŠØ¨ÙŠ",
        expiresAt:"Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©"
      },
      createdBy:uid
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");

    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ
    const managerEmail = "demo@oma.edu";
    const managerPassword = "123456demo";
    const managerCred = await createUserWithEmailAndPassword(auth, managerEmail, managerPassword);
    const managerUid = managerCred.user.uid;

    await setDoc(doc(db,"users",managerUid),{
      name:"Ù…Ø¯ÙŠØ± Ù…Ø¹Ù‡Ø¯ OMA Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",
      email:managerEmail,
      type:"instituteAdmin",
      instituteId:instituteId,
      createdAt:serverTimestamp()
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");

    // Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù…Ø¹Ù‡Ø¯
    await setDoc(doc(db,`institutes/${instituteId}/settings/general`),{
      openHours:"8:00 AM - 5:00 PM",
      contact:"07800000000",
      address:"Ø¨ØºØ¯Ø§Ø¯ - Ø§Ù„Ø¹Ø±Ø§Ù‚",
      updatedAt:serverTimestamp()
    });

    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ø¹Ù‡Ø¯.");
    write("ğŸ‰ ØªÙ…Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ£Ø­Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:\n");
    write("ğŸ”¹ Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…:\n   Ø§Ù„Ø¨Ø±ÙŠØ¯: Salahalkaleefa@gmail.com\n   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: 123456salah\n");
    write("ğŸ”¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ:\n   Ø§Ù„Ø¨Ø±ÙŠØ¯: demo@oma.edu\n   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: 123456demo\n");
    write("\nØ§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© login.html Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
  } catch (err) {
    console.error(err);
    write("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©: " + err.message);
  }
});
</script>
</body>
</html>
