<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… OMA</title>
<style>
body {
  font-family: 'Cairo', sans-serif;
  background: #f5f9ff;
  text-align: center;
  padding: 40px;
  color: #004aad;
}
button {
  padding: 12px 25px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #004aad;
  color: white;
  cursor: pointer;
}
button:hover { background: #003a8c; }
#log {
  margin-top: 20px;
  white-space: pre-wrap;
  text-align: right;
  background: #fff;
  border-radius: 10px;
  padding: 20px;
  max-width: 600px;
  margin: auto;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
</style>
</head>
<body>
<h2>ğŸ”§ ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… OMA</h2>
<p>Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ.</p>
<button id="initBtn">Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</button>
<div id="log"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAMANgdrLgoGIjqLZOcS_qyEqCUOVC7gOU",
  authDomain: "oma0-33cc0.firebaseapp.com",
  projectId: "oma0-33cc0",
  storageBucket: "oma0-33cc0.firebasestorage.app",
  messagingSenderId: "899300774863",
  appId: "1:899300774863:web:0a81a7f5747ef37d49b8ba",
  measurementId: "G-5CKWYQT9XZ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const log = document.getElementById("log");
const btn = document.getElementById("initBtn");
function write(msg){ log.innerHTML += `âœ… ${msg}\n`; }

btn.addEventListener("click", async()=>{
  btn.disabled = true;
  write("ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...");

  try {
    // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… (superAdmin)
    const superEmail = "Salahalkaleefa@gmail.com";
    const superPass = "123456salah";
    const superCred = await createUserWithEmailAndPassword(auth, superEmail, superPass);
    const superUid = superCred.user.uid;
    await setDoc(doc(db,"users",superUid),{
      name: "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…",
      email: superEmail,
      type: "superAdmin",
      createdAt: serverTimestamp()
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… superAdmin Ø¨Ù†Ø¬Ø§Ø­.");

    // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ù‡Ø¯ ØªØ¬Ø±ÙŠØ¨ÙŠ
    const instituteId = "demo-institute";
    await setDoc(doc(db,"institutes",instituteId),{
      name: "Ù…Ø¹Ù‡Ø¯ OMA Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",
      adminEmail: "demo@oma.edu",
      logo: "https://i.ibb.co/vqC4ZP6/institute-logo.png",
      colors: {
        primary: "#004aad",
        accent: "#ffcc33",
        bg: "#f5f9ff",
        card: "#ffffff"
      },
      createdAt: serverTimestamp(),
      subscription: {
        type: "ØªØ¬Ø±ÙŠØ¨ÙŠ",
        expires: "Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©"
      },
      createdBy: superUid
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");

    // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ
    const managerEmail = "demo@oma.edu";
    const managerPass = "123456demo";
    const managerCred = await createUserWithEmailAndPassword(auth, managerEmail, managerPass);
    const managerUid = managerCred.user.uid;
    await setDoc(doc(db,"users",managerUid),{
      name: "Ù…Ø¯ÙŠØ± Ù…Ø¹Ù‡Ø¯ OMA Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",
      email: managerEmail,
      type: "instituteAdmin",
      instituteId: instituteId,
      colors: {
        primary: "#004aad",
        accent: "#ffcc33",
        bg: "#f5f9ff",
        card: "#ffffff"
      },
      createdAt: serverTimestamp()
    });
    write("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");

    // âœ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ø¹Ù‡Ø¯
    await setDoc(doc(db,`institutes/${instituteId}/settings/general`),{
      openHours: "8:00 AM - 5:00 PM",
      contact: "07800000000",
      address: "Ø¨ØºØ¯Ø§Ø¯ - Ø§Ù„Ø¹Ø±Ø§Ù‚",
      updatedAt: serverTimestamp()
    });
    write("ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ø¹Ù‡Ø¯.");

    write("ğŸ‰ ØªÙ…Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¨Ù†Ø¬Ø§Ø­!");
    write("ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…:");
    write("ğŸ”¹ Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…: Salahalkaleefa@gmail.com / 123456salah");
    write("ğŸ”¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¹Ù‡Ø¯: demo@oma.edu / 123456demo");

  } catch(err){
    console.error(err);
    write("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©: " + err.message);
    btn.disabled = false;
  }
});
</script>
</body>
</html>